:toc: macro
:toc-title:
:toclevels: 2

= Swift Metrics Collector

toc::[]

== EN üá¨üáß

üìä A tool to collect some code metrics from code written in Swift ‚àô (early 2023)

This is part of my graduating project.

=== Metrics

The metrics collected by the tool are inspired by the suite described in the link:https://www.doi.org/10.1109/32.295895[article "A Metrics Suite for Object Oriented Design" by Chidamber, S. and Kemerer, C.].

They are:

* Weighted Methods per Class (WMC)
* Number Of Childrem (NOC)
* Depth of Inheritance Tree (DIT)
* Lack of Cohesion in Methods (LCOM)
    ** This metric calculation differs from the one defined in the article by Chidamber and Kemerer. Instead, I decided to use the definition from the link:https://www.researchgate.net/publication/238729882_Measuring_coupling_and_cohesion_in_object-oriented_systems[article "Measuring coupling and cohesion in object-oriented systems" by Hitz, M. and Montazeri, B.].
* Response For a Class (RFC)
* Coupling Between Object classes (CBO)

=== Tool validation

I wrote a few test cases to validate the tool and implemented them as automated tests in Xcode. The test case descriptions are link:Casos_de_Teste[only available in portuguese] and their implementation is available on link:Swift-Metrics-Collector/SMCKit/SMCKitTests/Test%20Cases[Test Cases].

There's a variable used by the test cases that depends of the location of the project in yout machine. To configure this variable, use the template file `UserSettings_template.swift` localized at 'Swift-Metrics-Collector/SMCKit/SMCKitTests/'. You just have to create a new file named `UserSettings.swift` at this same location and copy the template content replacing `PATH_TO_REPO` with the repository's path on your machine.

[, swift]
----
enum UserSettings {
    static let projectPath = "PATH_TO_REPO/Swift-Metrics-Collector"
}
----

=== Limitations

There are some scenarios in which the tool doesn't calculate the metrics correctly. The known limitations are described with exemples in link:Limitacoes.adoc[Limita√ß√µes] (descriptions only available in portuguese).

=== Usage

There's no built version of the tool, you have to use it throught Xcode for now.

This is a CLI tool Xcode project. The arguments and options are the following:

[, shell]
----
USAGE: swift-metrics-collector <path> [--csv] [--json] [--output-directory-path <output-directory-path>]

ARGUMENTS:
  <path>                  Path of the file or directory to be analyzed

OPTIONS:
  --csv/--json            Report file format (default: --csv)
  --output-directory-path <output-directory-path>
                          Path where to save the tool's output files (default:
                          ~/Downloads/)
  -h, --help              Show help information.
----

Before running the tool, use Xcode to edit the SMCCLI scheme and set the desired arguments.

image::Docs_images/Xcode_scheme_arguments.png[Screenshot of Xcode showing the "Arguments Passed On Launch" for the SCMCLI scheme]


== PT-BR üáßüá∑

üìä Uma ferramenta para coletar algumas m√©tricas de c√≥digo escrito em Swift ‚àô (in√≠cio de 2023)

Este projeto faz parte do meu Trabalho de Gradua√ß√£o.

=== M√©tricas

As m√©tricas coletadas pela ferramenta foram inspiradas na su√≠te descrita no link:https://www.doi.org/10.1109/32.295895[artigo "A Metrics Suite for Object Oriented Design" de Chidamber, S. e Kemerer, C.].

Elas s√£o (em tradu√ß√£o livre):

* M√©todos ponderados por classe (Weighted Methods per Class - WMC)
* N√∫mero de filhos (Number Of Childrem - NOC)
* Profundidade da √°rvore de heran√ßa (Depth of Inheritance Tree - DIT)
* Falta de coes√£o em m√©todos (Lack of Cohesion in Methods - LCOM)
    ** O c√°lculo dessa m√©trica difere daquele definido no artigo de Chidamber e Kemerer. Em vez disso, eu decidi usar a defini√ß√£o do link:https://www.researchgate.net/publication/238729882_Measuring_coupling_and_cohesion_in_object-oriented_systems[artigo "Measuring coupling and cohesion in object-oriented systems" de Hitz, M. e Montazeri, B.].
* Resposta para uma classe (Response For a Class - RFC)
* Acoplamento entre classes de objeto (Coupling Between Object classes - CBO)

=== Valida√ß√£o da ferramenta

Escrevi alguns casos de teste para validar a ferramenta e implementei eles como testes automatizados no Xcode. Eles est√£o descritos em link:Casos_de_Teste[Casos de Teste] e implementados em link:Swift-Metrics-Collector/SMCKit/SMCKitTests/Test%20Cases[Test Cases].

Existe uma vari√°vel utilizada pelos casos de teste que depende da localiza√ß√£o do projeto na sua m√°quina. Para configurar essa vari√°vel, use o arquivo de template `UserSettings_template.swift` localizado em 'Swift-Metrics-Collector/SMCKit/SMCKitTests/'. Basta criar um novo arquivo chamado `UserSettings.swift` neste mesmo local e copiar o conte√∫do do template substituindo `PATH_TO_REPO` pelo caminho do reposit√≥rio em sua m√°quina.

[, swift]
----
enum UserSettings {
    static let projectPath = "PATH_TO_REPO/Swift-Metrics-Collector"
}
----

=== Limita√ß√µes

Existem alguns cen√°rios em que a ferramenta n√£o consegue calcular as m√©tricas de forma correta. As limita√ß√µes conhecidas est√£o descritas, com exemplos, em link:Limitacoes.adoc[Limita√ß√µes].

=== Utiliza√ß√£o

Ainda n√£o existe uma vers√£o buildada da ferramenta, voc√™ vai precisar us√°-la atrav√©s do Xcode por enquanto.

Esse √© um projeto de uma ferramenta CLI. Os argumentos e op√ß√µes s√£o os seguintes:

[, shell]
----
USAGE: swift-metrics-collector <path> [--csv] [--json] [--output-directory-path <output-directory-path>]

ARGUMENTS:
  <path>                  Path of the file or directory to be analyzed

OPTIONS:
  --csv/--json            Report file format (default: --csv)
  --output-directory-path <output-directory-path>
                          Path where to save the tool's output files (default:
                          ~/Downloads/)
  -h, --help              Show help information.
----

Antes de rodar a ferramenta, use o Xcode para editar o scheme SMCCLI e setar os argumentos desejados.

image::Docs_images/Xcode_scheme_arguments.png[Captura de tela do Xcode mostrando os "Arguments Passed On Launch" para o scheme SCMCLI]
